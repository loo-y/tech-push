# æœ¬åœ°å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–
```bash
npm install
```

### 2. å¯åŠ¨å®Œæ•´å¼€å‘ç¯å¢ƒ
```bash
npm run dev:full
```

è¿™ä¸ªå‘½ä»¤ä¼šåŒæ—¶å¯åŠ¨ï¼š
- Vite å¼€å‘æœåŠ¡å™¨ (ç«¯å£ 5173)
- Wrangler æœ¬åœ° Worker (ç«¯å£ 8787)

### 3. è®¿é—®åº”ç”¨
- **ä¸»é¡µé¢**: http://localhost:5173/
- **éŸ³é¢‘ä¸Šä¼ é¡µé¢**: http://localhost:5173/audio-upload
- **Worker API**: http://localhost:8787/

## ğŸ”§ å¼€å‘ç¯å¢ƒé…ç½®

### ç¯å¢ƒå˜é‡é…ç½®

åœ¨æœ¬åœ°å¼€å‘æ—¶ï¼Œä½ å¯ä»¥åœ¨ `wrangler.dev.toml` ä¸­é…ç½®ç¯å¢ƒå˜é‡ï¼š

```toml
[vars]
ENVIRONMENT = "development"
R2_BASE_URL = "http://localhost:8787"  # æœ¬åœ°å¼€å‘æ—¶çš„R2è®¿é—®URL
DEBUG = "true"
```

### R2 å­˜å‚¨é…ç½®

#### æ–¹æ¡ˆ1ï¼šä½¿ç”¨çœŸå®çš„ R2 Bucketï¼ˆæ¨èï¼‰
1. ç¡®ä¿ä½ æœ‰ Cloudflare è´¦æˆ·å’Œ R2 å­˜å‚¨æ¡¶
2. åœ¨ `wrangler.dev.toml` ä¸­é…ç½®çœŸå®çš„ bucket åç§°
3. è¿è¡Œ `wrangler dev --local` æ—¶ä¼šè¿æ¥åˆ°çœŸå®çš„ R2

#### æ–¹æ¡ˆ2ï¼šä½¿ç”¨æœ¬åœ°æ¨¡æ‹Ÿå­˜å‚¨
1. åˆ›å»ºä¸€ä¸ªæœ¬åœ°æ–‡ä»¶å­˜å‚¨æ¨¡æ‹Ÿ
2. ä¿®æ”¹ `AudioUploadService` ä»¥æ”¯æŒæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ
3. é€‚åˆå¿«é€ŸåŸå‹å¼€å‘

## ğŸ“ æ–‡ä»¶ç»“æ„è¯´æ˜

```
tech-push/
â”œâ”€â”€ wrangler.json          # ç”Ÿäº§ç¯å¢ƒé…ç½®
â”œâ”€â”€ wrangler.dev.toml      # æœ¬åœ°å¼€å‘é…ç½®
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ worker/
â”‚   â”‚   â”œâ”€â”€ audio/
â”‚   â”‚   â”‚   â”œâ”€â”€ upload.ts      # éŸ³é¢‘ä¸Šä¼ æœåŠ¡
â”‚   â”‚   â”‚   â””â”€â”€ routes.ts      # APIè·¯ç”±
â”‚   â”‚   â””â”€â”€ index.ts           # Workerå…¥å£
â”‚   â””â”€â”€ react-app/
â”‚       â”œâ”€â”€ components/
â”‚       â”‚   â””â”€â”€ AudioUpload.tsx # éŸ³é¢‘ä¸Šä¼ ç»„ä»¶
â”‚       â””â”€â”€ pages/
â”‚           â””â”€â”€ AudioUploadPage.tsx # éŸ³é¢‘ä¸Šä¼ é¡µé¢
```

## ğŸŒ ç½‘ç»œè¯·æ±‚æµç¨‹

### æœ¬åœ°å¼€å‘ç¯å¢ƒ
```
æµè§ˆå™¨ â†’ localhost:5173 (React App)
           â†“
        localhost:8787 (Worker)
           â†“
        Cloudflare R2 (æˆ–æœ¬åœ°å­˜å‚¨)
```

### ç”Ÿäº§ç¯å¢ƒ
```
æµè§ˆå™¨ â†’ your-worker.workers.dev
           â†“
        Cloudflare R2
```

## ğŸ” è°ƒè¯•æŠ€å·§

### 1. æŸ¥çœ‹ Worker æ—¥å¿—
```bash
npm run dev:worker
```
Worker æ—¥å¿—ä¼šæ˜¾ç¤ºåœ¨ç»ˆç«¯ä¸­ã€‚

### 2. æŸ¥çœ‹ç½‘ç»œè¯·æ±‚
åœ¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·çš„ Network æ ‡ç­¾ä¸­æŸ¥çœ‹ï¼š
- API è¯·æ±‚åˆ° `/api/audio/*`
- æ–‡ä»¶ä¸Šä¼ è¯·æ±‚
- é™æ€èµ„æºåŠ è½½

### 3. è°ƒè¯• R2 å­˜å‚¨
```bash
# æŸ¥çœ‹ R2 bucket å†…å®¹
wrangler r2 object list insightcast-bucket

# ä¸Šä¼ æµ‹è¯•æ–‡ä»¶
wrangler r2 object put insightcast-bucket/test.txt --file ./test.txt
```

## ğŸ› å¸¸è§é—®é¢˜

### 1. R2 è®¿é—®æƒé™é—®é¢˜
**é—®é¢˜**: æ— æ³•è®¿é—® R2 bucket
**è§£å†³**: 
- ç¡®ä¿å·²ç™»å½• Cloudflare è´¦æˆ·
- æ£€æŸ¥ bucket åç§°æ˜¯å¦æ­£ç¡®
- éªŒè¯ API ä»¤ç‰Œæƒé™

### 2. ç«¯å£å†²çª
**é—®é¢˜**: ç«¯å£ 8787 è¢«å ç”¨
**è§£å†³**: 
```bash
# ä½¿ç”¨è‡ªå®šä¹‰ç«¯å£
wrangler dev --local --port 8788
```

### 3. æ–‡ä»¶ä¸Šä¼ å¤±è´¥
**é—®é¢˜**: ä¸Šä¼ æ—¶å‡ºç°é”™è¯¯
**è§£å†³**:
- æ£€æŸ¥æ–‡ä»¶å¤§å°é™åˆ¶ï¼ˆ50MBï¼‰
- éªŒè¯æ–‡ä»¶ç±»å‹ï¼ˆMP3, WAV, OGG, AAC, M4Aï¼‰
- æŸ¥çœ‹ Worker æ—¥å¿—è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯

### 4. è·¨åŸŸé—®é¢˜
**é—®é¢˜**: æµè§ˆå™¨é˜»æ­¢è·¨åŸŸè¯·æ±‚
**è§£å†³**:
- ç¡®ä¿ React åº”ç”¨å’Œ Worker ä½¿ç”¨æ­£ç¡®çš„ç«¯å£
- æ£€æŸ¥ CORS é…ç½®

## ğŸ“ å¼€å‘è„šæœ¬è¯´æ˜

```json
{
  "scripts": {
    "dev": "vite",                    // åªå¯åŠ¨ React å¼€å‘æœåŠ¡å™¨
    "dev:worker": "wrangler dev --local", // åªå¯åŠ¨ Worker
    "dev:full": "concurrently \"npm run dev\" \"npm run dev:worker\"", // åŒæ—¶å¯åŠ¨ä¸¤è€…
    "build": "tsc -b && vite build",  // æ„å»ºé¡¹ç›®
    "deploy": "wrangler deploy"       // éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
  }
}
```

## ğŸ”„ å¼€å‘å·¥ä½œæµ

1. **å¯åŠ¨å¼€å‘ç¯å¢ƒ**:
   ```bash
   npm run dev:full
   ```

2. **ä¿®æ”¹ä»£ç **:
   - React ç»„ä»¶: `src/react-app/`
   - Worker é€»è¾‘: `src/worker/`
   - æ ·å¼æ–‡ä»¶: `*.css`

3. **æµ‹è¯•åŠŸèƒ½**:
   - è®¿é—® http://localhost:5173/audio-upload
   - æµ‹è¯•æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½
   - æ£€æŸ¥ API å“åº”

4. **æ„å»ºå’Œéƒ¨ç½²**:
   ```bash
   npm run build
   npm run deploy
   ```

## ğŸ¯ æœ€ä½³å®è·µ

1. **ç¯å¢ƒåˆ†ç¦»**: ä½¿ç”¨ä¸åŒçš„é…ç½®æ–‡ä»¶ç®¡ç†å¼€å‘å’Œç”Ÿäº§ç¯å¢ƒ
2. **é”™è¯¯å¤„ç†**: åœ¨å¼€å‘ç¯å¢ƒä¸­å¯ç”¨è¯¦ç»†é”™è¯¯æ—¥å¿—
3. **æµ‹è¯•æ•°æ®**: ä½¿ç”¨çœŸå®çš„éŸ³é¢‘æ–‡ä»¶è¿›è¡Œæµ‹è¯•
4. **ç‰ˆæœ¬æ§åˆ¶**: ç¡®ä¿é…ç½®æ–‡ä»¶ä¸­çš„æ•æ„Ÿä¿¡æ¯ä¸è¢«æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [Cloudflare Workers æ–‡æ¡£](https://developers.cloudflare.com/workers/)
- [Wrangler CLI æ–‡æ¡£](https://developers.cloudflare.com/workers/wrangler/)
- [Cloudflare R2 æ–‡æ¡£](https://developers.cloudflare.com/r2/)
- [Vite å¼€å‘æœåŠ¡å™¨æ–‡æ¡£](https://vitejs.dev/guide/) 